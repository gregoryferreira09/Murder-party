<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Rôle et Indices - Murder Party</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../../Public/styles/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative&family=Cormorant+Garamond&display=swap" rel="stylesheet">
</head>
<body>
  <header>
    <div class="bandeau-dore">
      <h1>🕵️ Murder Party - Rôle & Indices</h1>
    </div>
  </header>

  <div class="bandeau-dore" style="margin-top: 30px;">
    <div id="chrono">Temps restant : <span id="tempsRestant">30:00</span> | Connexions restantes : <span id="connexionRestantes">5</span></div>

    <div class="tabs" style="margin-bottom:20px;">
      <button class="gold-btn tab-button active" onclick="switchTab('fiche')">🎭 Personnage</button>
      <button class="gold-btn tab-button" onclick="switchTab('indices')">🧩 Indices</button>
      <button class="gold-btn tab-button" onclick="switchTab('vote')">⚖️ Vote</button>
      <button class="gold-btn tab-button" onclick="switchTab('connexion')">🤝 Connexion</button>
    </div>

    <section id="fiche" class="tab-content active fiche-personnage">
      <h2>Nom : <span id="nomPersonnage">Inspecteur Alaric</span></h2>
      <img src="image-personnage.jpg" alt="Image du Personnage" style="width:80px; border-radius:50%; border:3px solid #e9c78c;">
      <p><strong>Histoire :</strong> Ancien détective de Scotland Yard, rongé par un passé trouble...</p>
      <p><strong>Pouvoir :</strong> Interrogez deux joueurs à chaque tour...</p>
    </section>

    <section id="indices" class="tab-content">
      <h3>Vos indices :</h3>
      <div id="listeIndices"></div>
    </section>

    <section id="vote" class="tab-content">
      <h3>Votez pour un suspect :</h3>
      <form id="voteForm">
        <select id="suspect"></select>
        <button type="submit" class="gold-btn">Voter</button>
      </form>
      <div id="voteResult" style="margin-top: 10px;"></div>
    </section>

    <section id="connexion" class="tab-content">
      <h3>Connexion entre joueurs :</h3>
      <div class="connexion-joueur" id="joueursList"></div>
      <button class="gold-btn" onclick="validerConnexion()">Valider la connexion</button>
    </section>
  </div>

  <footer class="footer">
    <button class="btn-retour" onclick="window.location.href='accueil.html'">🏠 Accueil</button><br>
    <p>© 2025 Murder Party. Tous droits réservés. <a href="mentions-legales.html">Mentions légales</a></p>
  </footer>

  <div class="effet-elimination" id="effetElimination"></div>

  <script>
    const joueurs = [
      { nom: 'Violette', image: 'violette.jpg', indices: ["A été vue avec la victime peu avant le crime.", "Semblait nerveuse lors du dîner."], fiabilite: "fiable" },
      { nom: 'Brume', image: 'brume.jpg', indices: ["Possède une clé suspecte.", "A disparu 10 minutes pendant la soirée."], fiabilite: "suspect" }
    ];
    let connexionsRestantes = 5;
    let joueurSelectionne = null;

    function switchTab(tabName) {
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
      document.getElementById(tabName).classList.add('active');
      document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
    }

    function initialiserJoueurs() {
      const select = document.getElementById('suspect');
      const joueursDiv = document.getElementById('joueursList');
      joueurs.forEach(j => {
        select.innerHTML += `<option value="${j.nom}">${j.nom}</option>`;
        const div = document.createElement('div');
        div.innerHTML = `<img src="${j.image}" alt="${j.nom}"><br>${j.nom}`;
        div.onclick = () => joueurSelectionne = j;
        joueursDiv.appendChild(div);
      });
    }

    function validerConnexion() {
      if (!joueurSelectionne || connexionsRestantes <= 0) return alert("Connexion impossible.");
      connexionsRestantes--;
      document.getElementById("connexionRestantes").textContent = connexionsRestantes;

      const indice = joueurSelectionne.indices[Math.floor(Math.random() * joueurSelectionne.indices.length)];
      const estFiable = joueurSelectionne.fiabilite === "fiable";
      const fiabiliteTexte = estFiable ? "Haute" : "Douteuse";
      const fiabiliteClasse = estFiable ? "fiable" : "suspect";

      const indiceDiv = document.createElement('div');
      indiceDiv.className = 'indice';
      indiceDiv.innerHTML = `<p>🔍 "${indice}"</p><p><span class="fiabilite ${fiabiliteClasse}">Fiabilité : ${fiabiliteTexte}</span></p>`;
      document.getElementById('listeIndices').appendChild(indiceDiv);

      // Bonus spécial aléatoire
      if (Math.random() < 0.25) {
        alert("Vous ressentez une connexion étrange... un souvenir refait surface !");
        const bonus = document.createElement('div');
        bonus.className = 'indice';
        bonus.innerHTML = `<p>🎁 Un indice bonus vous traverse l'esprit : "Un allié secret pourrait être proche..."</p>`;
        document.getElementById('listeIndices').appendChild(bonus);
      }
    }

    document.getElementById('voteForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const suspect = document.getElementById('suspect').value;
      document.getElementById('voteResult').innerHTML = `<p>🕯️ Votre vote pour <strong>${suspect}</strong> a été scellé...</p>`;
      // Effet visuel d'élimination
      const effet = document.getElementById("effetElimination");
      effet.classList.add("visible");
      setTimeout(() => effet.classList.remove("visible"), 2000);
    });

    // Chronomètre
    let secondes = 1800;
    function updateChrono() {
      const minutes = Math.floor(secondes / 60);
      const sec = secondes % 60;
      document.getElementById("tempsRestant").textContent = `${minutes}:${sec < 10 ? '0' : ''}${sec}`;
      if (secondes > 0) secondes--;
    }
    setInterval(updateChrono, 1000);

    initialiserJoueurs();
  </script>
</body>
</html>
